<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.88.1">
    <title>注册页面</title>


    <!-- Bootstrap core CSS -->
      <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-siteuser-select: none;
        -moz-siteuser-select: none;
        siteuser-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>


    <!-- Custom styles for this template -->
    <style>
      html,
body {
  height: 100%;
}
body {
  display: flex;
  align-items: center;
  padding-top: 40px;
  padding-bottom: 40px;
  background-color: #f5f5f5;
}

.form-signin {
  width: 100%;
  max-width: 330px;
  padding: 15px;
  margin: auto;
}

.form-signin .checkbox {
  font-weight: 400;
}

.form-signin  {
  z-index: 2;
}

.form-signin #Phonenumber {
  margin-bottom: 10px;
  border-top-left-radius: 0px;
  border-top-right-radius: 0px;
}

.form-signin #floatingInput {
  margin-bottom: -1px;
  border-bottom-left-radius: 0px;
  border-bottom-right-radius: 0px;
}


.form-signin input[type="password"] {
  margin-bottom: -1px;
  border-radius: 0px;
}

    </style>
  </head>
  <body class="text-center">

<main class="form-signin">
  <form method="post" action="/register/check" onsubmit="return Checkform();">
<!-- {#    <img class="mb-4" src="../assets/brand/bootstrap-logo.svg" alt="" width="72" height="57">#} -->
<svg xmlns="http://www.w3.org/2000/svg" style="color: purple;" width="120" height="120" fill="currentColor" class="bi bi-chat-left-dots" viewBox="0 0 16 16">
  <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
  <path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
</svg>
    <h1 class="h3 mb-3 fw-normal">注册界面</h1>

    <div class="form-floating">
      <input name="user" type="text" class="form-control" id="floatingInput" placeholder="用户名" min="6" maxlength="20" required="required">
      <label for="floatingInput">用户名</label>
    </div>
    <div class="form-floating">
      <input name="pwd"type="password" class="form-control" id="floatingPassword" placeholder="密码" min="6" maxlength="20" required="required">
      <label for="floatingPassword">密码</label>
    </div>
    <div class="form-floating">
      <input name="pwd2" type="password" class="form-control" id="SecondPassword" placeholder="确认密码" min="6" maxlength="20" required="required">
      <label for="SecondPassword">确认密码</label>
    </div>
    <div class="alert alert-primary" role="alert" id="message">
      注意：用户名和密码应该仅由数字和字母组成！
    </div>
      <!--/*@thymesVar id="iserr" type="String"*/-->
      <div th:if="${iserr=='1'}">
          <div class="alert alert-danger" role="alert">
          注册异常:该用户已存在
         </div>
      </div>
    <div class="checkbox mb-3">
      <label>
        <input type="checkbox" value="remember-me" name="remember"> 保持登录状态
      </label>
    </div>
    <button class="w-100 btn btn-lg btn-primary" type="submit" >注册</button>
    <p class="mt-5 mb-3 text-muted">&copy; 1911–2022</p>
  </form>
</main>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.2.3/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script>
  function Checkform(){
    var name=document.getElementById("floatingInput").value;
    var pwd=document.getElementById("floatingPassword").value;
    var pwd2=document.getElementById("SecondPassword").value;
    var message=document.getElementById("message");

    var regname=/^\w+$/;
    
    if(regname.test(name)==false||regname.test(pwd)==false){
      message.innerHTML="用户名或密码包含非法字符!";
      return false;
    }
    if(pwd!=pwd2){
      message.innerHTML="两次输入密码不一致!";
      return false;
    }
    // console.log(name+ " " + pwd);
    // sha256(pwd).then(hash => {
    //     document.getElementById("floatingPassword").value = hash;
    //     document.getElementById("SecondPassword").value = hash;
    //     console.log(hash)
    //     return true;
    // });
      var hash = CryptoJS.SHA256(pwd)
      document.getElementById("floatingPassword").value = hash;
      document.getElementById("SecondPassword").value = hash;
      return true;
  }
</script>
    
  </body>
</html>
